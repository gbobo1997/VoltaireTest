<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Login</title>
	<link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300" type="text/css" />
  <body id="canvas">
     <div class="loginArea" id="loginArea2">
        <center>
          <h1>Welcome to Project Voltaire</h1><br>
        <button type="button" onclick="rdsLogin()">Login</button>
        <button type="button" onclick="rdsSignup()">Signup</button>
      </center>
    </div>

  </body>
</html>
<script>
  checkLogin();
  function rdsLogin()
  {
    var content = '<center><h1>Welcome to Project Voltaire</h1><br><form>Username:<input type="text" name="uName" id="uName"><br>Password:<input type="text" name="password" id="pWord"><br><button type="button" onclick="loginConfirm()">Login</button></form></center>';
    document.getElementById("loginArea2").innerHTML = content;
  }

  function rdsSignup()
  {
    var content = '<center><h1>Welcome to Project Voltaire</h1><br><form>Username (Email):<input type="text" name="email" id="email"><br>Password:<input type="text" name="password" id="pWord"><br><button type="button" onclick="signupConfirm()">Signup</button></form></center>';
    document.getElementById("loginArea2").innerHTML = content;
  }

  function loginConfirm()
  {
    var username = document.getElementById("uName").value;
    var password = document.getElementById("pWord").value;

    // This should generate the api request message

    // heres where we would have a database query that hashes the password string and compares it against the hash associated with the username
    /*
    if(username == 'root' && password == 'test')
    {
      window.location.href = 'home.html';
    }
    else
    {
      alert("Incorrect Username or Password");
    }
    // we would recieve a token from the webserver, and set this in the session*/
    var returnToken = "asdlkasdn";


    localStorage.setItem('username', username);
    localStorage.setItem('token', returnToken);
  }

  function signupConfirm()
  {
    var email = document.getElementById("email").value;
    var password = document.getElementById("pWord").value;
    rdsLogin();

    //Call function that sends password/email to backend 
    // Currently am lazy so adding that would be a large amount of work
  }

  
  function checkLogin()
  {
    var username = localStorage.getItem('username');
    var token = localStorage.setItem('token');

    if (username != null)
    {
      window.location.href = 'home.html';
    }
    console.log('username: '+username);


  }

  function apiRequest()
  {
    const url = '/auth/login';
    var data = {
      name: username,
      password: password
    };

    const otherParams = {
      headers: {
        "content-type":"application/json; charset=UTF-8"
      },
      body: data,
      method: "POST"
    };

    fetch(url, otherParams)
    .then(data=>{return data.json()})
    .then(res=>{console.log(res)})
    .catch(error=>console.log(error))
  }
</script>